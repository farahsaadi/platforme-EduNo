<app-navbar></app-navbar>

<div class="container py-4">

  <h2 class="fw-bold mb-4 text-center">ğŸ“Œ Mes Publications</h2>

  <!-- Liste des publications -->
  <div class="row g-4">
    <div class="col-md-4" *ngFor="let pub of publications">
      <div class="card shadow-lg border-0 rounded-4 h-100 hover-card">

        <img src="../../assets/img/logo.png" 
             class="card-img-top rounded-top-4 img-fluid"
             style="height:200px; object-fit:cover;">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title fw-bold text-primary">{{ pub.titre }}</h5>
          
          <p class="text-muted small flex-grow-1">
            {{ pub.description | slice:0:100 }}...
          </p>

          <div class="d-flex gap-2 mt-auto">
            <button class="btn btn-outline-primary w-50 rounded-pill"
                    (click)="voirDetail(pub)">
              Voir dÃ©tail
            </button>
            <button class="btn btn-outline-danger w-50 rounded-pill"
                    (click)="supprimer(pub.id)">
              Supprimer
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION DETAIL / MODIFICATION -->
  <div *ngIf="showDetails && selectedPublication" 
       class="card shadow-lg border-0 p-4 mt-5 rounded-4">
    
    <h3 class="fw-bold text-primary mb-3">ğŸ“ Modifier la publication</h3>

    <div class="row g-4">
      
      <!-- Formulaire de modification -->
      <div class="col-md-7">
        
        <div class="mb-3">
          <label class="form-label fw-semibold">Titre</label>
          <input class="form-control rounded-3"
                 [(ngModel)]="selectedPublication.titre">
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">Description</label>
          <textarea class="form-control rounded-3" rows="4"
                    [(ngModel)]="selectedPublication.description"></textarea>
        </div>

        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label fw-semibold">Prix</label>
            <input class="form-control rounded-3"
                   [(ngModel)]="selectedPublication.prix">
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">CatÃ©gorie</label>
            <input class="form-control rounded-3"
                   [(ngModel)]="selectedPublication.categorie">
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Type</label>
            <input class="form-control rounded-3"
                   [(ngModel)]="selectedPublication.type_annonce">
          </div>
        </div>

        <div class="mt-3">
          <label class="form-label fw-semibold">Localisation</label>
          <input class="form-control rounded-3"
                 [(ngModel)]="selectedPublication.localisation">
        </div>

      </div>

      <!-- Informations vendeur -->
      <div class="col-md-5">
        <div class="p-3 bg-light rounded-4 border">
          <h5 class="fw-bold mb-3">ğŸ‘¤ Informations vendeur</h5>

          <p class="mb-1"><strong>Nom :</strong> {{ selectedPublication.user_nom }}</p>
          <p class="mb-1"><strong>TÃ©lÃ©phone :</strong> {{ selectedPublication.user_telephone }}</p>
          <p class="mb-1"><strong>Adresse :</strong> {{ selectedPublication.user_adresse }}</p>
        </div>
      </div>

    </div>

    <div class="mt-4 d-flex gap-3">
      <button class="btn btn-success rounded-pill px-4"
              (click)="saveModification()">
        ğŸ’¾ Enregistrer
      </button>
      <button class="btn btn-secondary rounded-pill px-4"
              (click)="showDetails = false">
        âŒ Fermer
      </button>
    </div>

  </div>
</div>
